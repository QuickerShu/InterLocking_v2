# ユーザー補助機能
アプリは、誰が見ても容易に取り扱える画面の表示・操作方法とする。レイアウトの配線略図を画面に表示し、直感的に操作できるだけでなく、運用するために必要なシステム設定やシステムの初期化機能などの補助機能も操作性が悪くならないようにデザインする。

## アプリ起動時のシステム初期化
アプリ起動直後はデータ定義のない白紙の配線略図画面、空欄の進路一覧ウィンドウを表示する。ユーザーは、連動情報ファイルを開いて運転を開始する。システムの初期化機能はボタンにより実行し、読み込んだファイルの内容と現場装置との設定内容の同期を行う。具体的には、ポイント開通位置の初期化（すべて定位位置に切り替え）、アプリで設定した信号機の設定構成と現場の機器構成の一致確認などを行う。

初期化中はプログレスバーを表示した初期化中ウィンドウを表示し、初期化処理中の間、どの項目を処理しているかリアルタイムに確認できるようにする。

## 連動装置の設定項目
連動装置の動作を決定するシステム設定はアプリ上でシステムプロパティとして設定項目を集約し、連動装置の動作や現場装置の設定を行う。タブにより機能ごとに各種設定を行えるようにする。

- 描画設定
  - 連動装置の登録進路数・連動種別、制御信号数、軌道回路数の表示
  - 軌道回路名、線路名、ポイント番号、ポイントDCC-IDの表示有無
  - 編成番号の画面表示有無
  - 配線略図画面のサイズ（画面スクロールの範囲を決める）
- 接近鎖錠・保留鎖錠標準秒数の設定（進路設定時、個別設定しない場合に適用する秒数）
- 進路の自動復位有効・無効

## データ別の詳細設定
アプリには様々なデータテーブルがある、線路データ、ポイントデータ、信号機データ、進路データなど、アプリ内で作成される各種データは、データごとに専用のプロパティウィンドウで設定できるようにする。専用のウィンドウで設定できるようにすることで設定漏れを防ぎ、各項目をまとめて設定することができるようにする。例えば線路プロパティでは、線路名称、参照する軌道回路データの設定を選択する。

## 配線略図画面でのユーザー操作機能
配線略図画面では、ユーザーが特定の設備を選択した場合は強調表示するようにする。レールを選択した場合は、レールが強調表示され、水色に表示される。同様に、進路において選択した進路が走行する線路を水色に、発点てこを選択した場合はてこを水色に着色する。

## 連動装置設定項目の自動検証
ユーザーが入力した項目が正しく設定されているか、誤って設定していないか自動検証する機能を盛り込む。検証機能は設備の分類ごとに以下の項目に分かれる。

- 配線略図検査
  - 作成した配線略図の各パーツ群が正しく接続されているかを検証
- ポイント検査
  - ポイントデータが現場のポイント制御番号と一致しているかを検証
- フィーダー割当検査
  - フィーダー切替での電源出力先が複数に設定されていないか検証
- 信号設備検査
  - てこの配置状態や信号機の現示系統が崩れていないか検証
- 軌道回路検査
  - 軌道回路の番号が配線略図内の離れた箇所で複数設定されていないか検証
- 連動検査
  - 進路データと信号機データの連携など、各種設定に誤りがないか検証
- 現場設備検査
  - アプリ上での設定情報と現場装置（信号機など）の設定情報が合致しているか検証

上記すべての検査項目が完了しないと連動装置の運用ができないシステムとする。検査にて問題を発見した場合にはユーザーに通知し、データの修正を促す。検査項目が多い検査の場合は、検査の結果を専用のウィンドウで表示する。ウィンドウ内での表示は問題がなければ黒色、設定不備ではないが注意を促す内容を黄色、設定不備の場合は赤色で表示する。問題の項目が見つかった場合、ウィンドウ内の問題項目を確認して修正対応できるようにする。

また、すべての検査項目の状態は小ウィンドウにて表示し、検査未完了の項目を一目で確認できるようにする。赤色は検査未完了で、緑色で検査完了済みを表示し、アプリが現在どのステータスにあるかを一目で確認できるようにする。

## データ作成から運用開始までの流れ
アプリを起動し、配線略図作成から連動装置として運用を開始するまでの流れは、次の通りである。

1. 配線略図作成→配線略図検査
2. 信号設備配置→信号設備検査
3. データ紐づけ→ポイント検査、フィーダー検査、軌道回路検査
4. 進路作成→連動検査
5. 現場設備検証→現場設備検査
6. 運用開始

作成するデータの種類ごとにステップを分け、ステップ単位で検査を実行する。検査機能を段階的に実行することで、作成したデータの内容に問題がないか1つ1つ確認しながら運用開始まで進めていけるようにする。

連動装置として運用を開始するまでの流れは、まずユーザーが配線略図データを作図していく。作図完了後、配線略図検査を実施し配線略図を確定させる。配線略図確定後はてこ・信号機等の信号関係設備を配置し、連動装置で制御するすべての設備を配置する。全設備の配置が完了したら、作成した配線略図・信号機に現場のポイント番号、軌道回路、信号機のデータ紐付けを行う。最後に進路データを作成し、進路データと制御する信号機を設定して連動検査を実行する。連動検査が完了すると、アプリ上のすべての設定が完了する。すべての設定が完了後は、現場設備検査にて現場の各装置と通信して設定情報を現場装置に書き込み、ポイント切替や進路開通確認など動作確認して運用開始となる。